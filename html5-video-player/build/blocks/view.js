(()=>{"use strict";const e=window.React,t=(t,r={},s=!1)=>{const[n,a]=(0,e.useState)(!s),[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),[p,u]=(0,e.useState)(null);if(!wp.ajax)return void console.error("Please use wp-util as a dependency");const d=(e={})=>{a(!0),o(!1),c(null),wp.ajax.post(t,{...r,...e}).done(e=>{u(e),a(!1)}).fail(e=>{o(!0),c(e),a(!1)})},h=async(e={})=>{d(e)};return(0,e.useEffect)(()=>{s||d(r)},[]),{data:p,saveData:h,refetch:h,isLoading:n,isError:i,error:l}},r=function(e){return/^(?:(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?([a-zA-Z0-9_-]+))$/.test(e)?e:!!/^[a-zA-Z0-9_-]{11}$/.test(e)&&`https://www.youtube.com/watch?v=${e}`};var s=Symbol.for("immer-nothing"),n=Symbol.for("immer-draftable"),a=Symbol.for("immer-state");function i(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var o=Object.getPrototypeOf;function l(e){return!!e&&!!e[a]}function c(e){return!!e&&(u(e)||Array.isArray(e)||!!e[n]||!!e.constructor?.[n]||f(e)||_(e))}var p=Object.prototype.constructor.toString();function u(e){if(!e||"object"!=typeof e)return!1;const t=o(e);if(null===t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===p}function d(e,t){0===h(e)?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,s)=>t(s,r,e))}function h(e){const t=e[a];return t?t.type_:Array.isArray(e)?1:f(e)?2:_(e)?3:0}function m(e,t){return 2===h(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function y(e,t,r){const s=h(e);2===s?e.set(t,r):3===s?e.add(r):e[t]=r}function f(e){return e instanceof Map}function _(e){return e instanceof Set}function v(e){return e.copy_||e.base_}function b(e,t){if(f(e))return new Map(e);if(_(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=u(e);if(!0===t||"class_only"===t&&!r){const t=Object.getOwnPropertyDescriptors(e);delete t[a];let r=Reflect.ownKeys(t);for(let s=0;s<r.length;s++){const n=r[s],a=t[n];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[n]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[n]})}return Object.create(o(e),t)}{const t=o(e);if(null!==t&&r)return{...e};const s=Object.create(t);return Object.assign(s,e)}}function w(e,t=!1){return E(e)||l(e)||!c(e)||(h(e)>1&&(e.set=e.add=e.clear=e.delete=g),Object.freeze(e),t&&Object.entries(e).forEach(([e,t])=>w(t,!0))),e}function g(){i(2)}function E(e){return Object.isFrozen(e)}var S,k={};function P(e){const t=k[e];return t||i(0),t}function T(){return S}function L(e,t){t&&(P("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function z(e){C(e),e.drafts_.forEach(I),e.drafts_=null}function C(e){e===S&&(S=e.parent_)}function $(e){return S={drafts_:[],parent_:S,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function I(e){const t=e[a];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function N(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return void 0!==e&&e!==r?(r[a].modified_&&(z(t),i(4)),c(e)&&(e=x(t,e),t.parent_||O(t,e)),t.patches_&&P("Patches").generateReplacementPatches_(r[a].base_,e,t.patches_,t.inversePatches_)):e=x(t,r,[]),z(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==s?e:void 0}function x(e,t,r){if(E(t))return t;const s=t[a];if(!s)return d(t,(n,a)=>j(e,s,t,n,a,r)),t;if(s.scope_!==e)return t;if(!s.modified_)return O(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const t=s.copy_;let n=t,a=!1;3===s.type_&&(n=new Set(t),t.clear(),a=!0),d(n,(n,i)=>j(e,s,t,n,i,r,a)),O(e,t,!1),r&&e.patches_&&P("Patches").generatePatches_(s,r,e.patches_,e.inversePatches_)}return s.copy_}function j(e,t,r,s,n,a,i){if(l(n)){const i=x(e,n,a&&t&&3!==t.type_&&!m(t.assigned_,s)?a.concat(s):void 0);if(y(r,s,i),!l(i))return;e.canAutoFreeze_=!1}else i&&r.add(n);if(c(n)&&!E(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;x(e,n),t&&t.scope_.parent_||"symbol"==typeof s||!Object.prototype.propertyIsEnumerable.call(r,s)||O(e,n)}}function O(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&w(t,r)}var A={get(e,t){if(t===a)return e;const r=v(e);if(!m(r,t))return function(e,t,r){const s=q(t,r);return s?"value"in s?s.value:s.get?.call(e.draft_):void 0}(e,r,t);const s=r[t];return e.finalized_||!c(s)?s:s===M(e.base_,t)?(W(e),e.copy_[t]=H(s,e)):s},has:(e,t)=>t in v(e),ownKeys:e=>Reflect.ownKeys(v(e)),set(e,t,r){const s=q(v(e),t);if(s?.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const s=M(v(e),t),o=s?.[a];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(((n=r)===(i=s)?0!==n||1/n==1/i:n!=n&&i!=i)&&(void 0!==r||m(e.base_,t)))return!0;W(e),D(e)}var n,i;return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==M(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,W(e),D(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const r=v(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:s.enumerable,value:r[t]}:s},defineProperty(){i(11)},getPrototypeOf:e=>o(e.base_),setPrototypeOf(){i(12)}},F={};function M(e,t){const r=e[a];return(r?v(r):e)[t]}function q(e,t){if(!(t in e))return;let r=o(e);for(;r;){const e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=o(r)}}function D(e){e.modified_||(e.modified_=!0,e.parent_&&D(e.parent_))}function W(e){e.copy_||(e.copy_=b(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function H(e,t){const r=f(e)?P("MapSet").proxyMap_(e,t):_(e)?P("MapSet").proxySet_(e,t):function(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:T(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,a=A;r&&(n=[s],a=F);const{revoke:i,proxy:o}=Proxy.revocable(n,a);return s.draft_=o,s.revoke_=i,o}(e,t);return(t?t.scope_:T()).drafts_.push(r),r}function R(e){if(!c(e)||E(e))return e;const t=e[a];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=b(e,t.scope_.immer_.useStrictShallowCopy_)}else r=b(e,!0);return d(r,(e,t)=>{y(r,e,R(t))}),t&&(t.finalized_=!1),r}d(A,(e,t)=>{F[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),F.deleteProperty=function(e,t){return F.set.call(this,e,t,void 0)},F.set=function(e,t,r){return A.set.call(this,e[0],t,r,e[0])};var V=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"==typeof e&&"function"!=typeof t){const r=t;t=e;const s=this;return function(e=r,...n){return s.produce(e,e=>t.call(this,e,...n))}}let n;if("function"!=typeof t&&i(6),void 0!==r&&"function"!=typeof r&&i(7),c(e)){const s=$(this),a=H(e,void 0);let i=!0;try{n=t(a),i=!1}finally{i?z(s):C(s)}return L(s,r),N(n,s)}if(!e||"object"!=typeof e){if(n=t(e),void 0===n&&(n=e),n===s&&(n=void 0),this.autoFreeze_&&w(n,!0),r){const t=[],s=[];P("Patches").generateReplacementPatches_(e,n,t,s),r(t,s)}return n}i(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,t=>e(t,...r));let r,s;return[this.produce(e,t,(e,t)=>{r=e,s=t}),r,s]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var t;c(e)||i(8),l(e)&&(l(t=e)||i(10),e=R(t));const r=$(this),s=H(e,void 0);return s[a].isManual_=!0,C(r),s}finishDraft(e,t){const r=e&&e[a];r&&r.isManual_||i(9);const{scope_:s}=r;return L(s,t),N(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(0===s.path.length&&"replace"===s.op){e=s.value;break}}r>-1&&(t=t.slice(r+1));const s=P("Patches").applyPatches_;return l(e)?s(e,t):this.produce(e,e=>s(e,t))}},B=V.produce;V.produceWithPatches.bind(V),V.setAutoFreeze.bind(V),V.setUseStrictShallowCopy.bind(V),V.applyPatches.bind(V),V.createDraft.bind(V),V.finishDraft.bind(V);var J=class{constructor(){this.callbacks={}}addEventListener(e,t){"function"==typeof t&&(void 0===this.callbacks[e]&&(this.callbacks[e]=[void 0]),this.callbacks[e].push(t))}on(e,t){this.addEventListener(e,t)}dispatchEvent(e,t){if(void 0===this.callbacks[e])return;let r=new J.Event;r.type=e,r.target=this,r.data=t,this.callbacks[e].forEach(e=>{"function"==typeof e&&e(r)})}},U=J;U.Event=class{constructor(){this.type="",this.target={},this.data={}}};const X=class extends U{constructor(e,t,r={},s=!1){super(),this.media=e,this.poster=null,this.initialized=!1,this.streamLoaded=!1,this.isPremium=s,this.features=r,this.options=B(t,e=>{e.markers.enabled=!0,t.speed&&(e.speed.options=t.speed.options.map(e=>parseFloat(e))),t.speed?.options?.[0]||(e.speed={options:[.5,.75,1,1.25,1.5,1.75,2]}),e.fullscreen={container:".plyr_wrapper",iosNative:!0},e.autoplay=!this.features.autoplayWhenVisible&&t.autoplay,e.ratio=t.ratio?.includes(":")?t.ratio:null}),this.local=window.h5vpBlock||{},t.urls.enabled||(this.options=B(this.options,e=>{e.urls.download=null})),this.media.closest(".plyr_wrapper")?.offsetWidth<=425&&(this.options=B(this.options,e=>{e.controls=this.options.controls.filter(e=>!["fast-forward","restart","rewind"].includes(e))})),this.options.muted?this.options=B(this.options,e=>{e.volume=0,e.storage.enabled=!1}):this.options=B(this.options,e=>{e.volume=.5,e.storage.enabled=!0}),setTimeout(()=>{this.player=new Plyr(this.media,{...this.options,i18n:window.h5vpI18n||{}}),"m3u8"===this.media.src?.split(".").pop()?this.videoHls():"mpd"===this.media.src?.split(".").pop()?this.videoDash():this.features.passwordProtected?.enabled||"none"===this.options.preload?this.player.on("loadedmetadata",()=>{this.initialized||(this.init(),this.player.play())}):this.init(),this.player.on("pause",()=>{this.features.disablePause&&this.player.play()}),window.instance||(window.instance=[]),window.instance.push(this.player),this.player.on("play",()=>{setTimeout(()=>{const e=this.player?.elements?.inputs?.seek;e&&e.value<=0&&this.player.on("timeupdate",()=>{const t=100/this.player.duration*this.player.currentTime;e&&(e.setAttribute("style",`--value:${t}%`),e.value=t)})},3e3)}),this.player.elements?.buttons?.mute?.addEventListener("click",()=>{0===this.player.volume&&(this.player.volume=.4)}),this.addEventListener("update-source",({data:e})=>{this.setSource(e.source,e.qualities,e.captions)}),this.player.on("ready",()=>{this.poster&&this.player.elements?.poster&&setTimeout(()=>{this.player.elements.poster.style.cssText=`background-image:url(${this.poster});`},500)})},500)}setIsPremium(e){this.isPremium=e}setSource(e=null,t=null){t=t||this.features.qualities;const r=t?.map(e=>({type:`video/${e?.video_file?.split(".").pop()}`,size:parseInt(e.size),src:e.video_file}))||[],s=this.features.captions?.map(e=>{if(e.caption_file){const t=e.label.split("/");return{kind:"captions",size:e.size,label:t[0],srclang:t[1],src:e.caption_file}}})||[];this.player.download=this.player.source,(this.player.source||e)&&r.push({src:this.player.source||e,type:"video/mp4",size:720}),this.player.source={type:"video",title:"",sources:r,poster:this.player.poster&&"false"!==this.player.poster?this.player.poster:""},s?.map(e=>{if(e?.src){const t=document.createElement("track");Object.assign(t,e),this.player.media.appendChild(t)}})}reInit(){this.init()}init(){if(!this.player)return void console.error("something went wrong!");this.initialized=!0;const e=this.features.qualities?.map(e=>({type:`video/${e?.video_file?.split(".").pop()}`,size:parseInt(e.size),src:e.video_file})).filter(e=>e.src)||[],t=this.features.captions?.map(e=>{const t=e.label.split("/");return{kind:"captions",size:e.size,label:t[0],srclang:t[1],src:e.caption_file}})||[];this.player.download=this.player.source,(this.media.src||this.player.source)&&e.push({src:this.media.src||this.player.source,type:"video/mp4",size:720}),this.player.source={type:"video",sources:e,poster:this.player.poster&&"false"!==this.player.poster?this.player.poster:""},t?.map(e=>{if(e?.src){const t=document.createElement("track");Object.assign(t,e),this.player.media.appendChild(t)}}),this.player.on("play",()=>{window.location.pathname.includes("/wp-admin")&&(this.player.pause(),this.player.currentTime=0)}),"object"==typeof this.features&&(this.makeElementSticky(this.features.sticky),this.createChapter(),this.watermark(this.features.watermark),this.thumbInPause(this.features?.thumbInPause),this.autoplayWhenVisible(),this.pauseOther(),this.createView(),this.landScapeWhenFullscreen()),this.player.on("play",()=>{this.disabled&&(this.player.currentTime=0,this.player.pause())}),this.player.on("ready",()=>{this.media.plyr=this.player,this.features.startTime&&setTimeout(()=>{this.player.currentTime=parseInt(this.features.startTime)},200),this.options.autoplay&&this.player?.play(),this.controlTouchAction();const e=this.player.elements?.progress?.offsetWidth;e<50&&!this.features.popup&&this.player.elements?.container?.classList?.add("h5vp_progressbar_up")})}setPoster(e){this.player?.elements?.poster&&e&&(this.player.elements.poster.style.backgroundImage=`url(${e})`)}createView(e=!1){this.player.on("pause",()=>{if(!this.videoId||!this.isPremium)return;let t=!1;const r=this.player?.currentTime;let s=localStorage.getItem(`video-progress-max-${this.videoId}`),n=new Date;s?s=JSON.parse(s):localStorage.setItem(`video-progress-max-${this.videoId}`,JSON.stringify({currentTime:r,created_at:n}));const a=(n-new Date(s?.created_at))/6e4;let i=!1;i=e?this.player.playing&&(r>=s?.currentTime||a>1440):r>=s?.currentTime||a>1440,i&&(a>1440&&(s.created_at=n),s.currentTime=this.player.currentTime,localStorage.setItem(`video-progress-max-${this.videoId}`,JSON.stringify(s)),t||(t=!0,wp.ajax.post("h5vp_ajax_handler",{nonce:this.nonce,model:"View",method:"createOrUpdate",video_id:this.videoId,duration:parseInt(this.player.currentTime)}).done(e=>{console.log(e)}).fail(e=>{console.log(e)})))})}autoplayWhenVisible(){if(this.features.playWhenVisible){let e=!1;this.player.on("ready",()=>{window.addEventListener("scroll",()=>{if(!this.isPremium)return!1;this.player.elements?.container?.offsetParent?.offsetTop<window.scrollY&&!e&&(this.player.muted=!0,this.player.play(),e=!0)})})}}makeElementSticky(e){if(!e?.enabled)return!1;const t=this.player.elements.fullscreen;if(t&&this.player){const r=t.getBoundingClientRect().top,s=function(e){let t=document.createElement("template");return t.innerHTML=e,t.content.firstChild}("<span class='close'>&times;</span>");window.addEventListener("scroll",()=>{if(!this.isPremium)return;const n=t.querySelector(".close");window.scrollY>=r&&this.player.playing?(t.classList.add(e.position),t.classList.add("sticky"),n||t.appendChild(s)):this.player.playing||(t.classList.remove("sticky"),t.classList.remove(e.position)),s.addEventListener("click",()=>{t.classList.remove(e.position),t.classList.remove("sticky"),this.player.pause()})})}}createChapter(){const e=this.player?.elements?.container,t=this.options.markers.points?.map(e=>({...e,time:this.chapterTimeToSeconds(e.time)}));if(!Array.isArray(t)||!e)return!1;const r=e.querySelector(".h5vp-chapter-wrapper");if(!t||r||!t.length)return!1;const s=document.createElement("div"),n=document.createElement("div"),a=document.createElement("button"),i=document.createElement("div");a.classList="h5vp-chapter-button plyr__controls__item plyr__control",a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 487.3 487.3"> <path d="M487.2,69.7c0,12.9-10.5,23.4-23.4,23.4h-322c-12.9,0-23.4-10.5-23.4-23.4s10.5-23.4,23.4-23.4h322.1 C476.8,46.4,487.2,56.8,487.2,69.7z M463.9,162.3H141.8c-12.9,0-23.4,10.5-23.4,23.4s10.5,23.4,23.4,23.4h322.1 c12.9,0,23.4-10.5,23.4-23.4C487.2,172.8,476.8,162.3,463.9,162.3z M463.9,278.3H141.8c-12.9,0-23.4,10.5-23.4,23.4 s10.5,23.4,23.4,23.4h322.1c12.9,0,23.4-10.5,23.4-23.4C487.2,288.8,476.8,278.3,463.9,278.3z M463.9,394.3H141.8 c-12.9,0-23.4,10.5-23.4,23.4s10.5,23.4,23.4,23.4h322.1c12.9,0,23.4-10.5,23.4-23.4C487.2,404.8,476.8,394.3,463.9,394.3z M38.9,30.8C17.4,30.8,0,48.2,0,69.7s17.4,39,38.9,39s38.9-17.5,38.9-39S60.4,30.8,38.9,30.8z M38.9,146.8 C17.4,146.8,0,164.2,0,185.7s17.4,38.9,38.9,38.9s38.9-17.4,38.9-38.9S60.4,146.8,38.9,146.8z M38.9,262.8 C17.4,262.8,0,280.2,0,301.7s17.4,38.9,38.9,38.9s38.9-17.4,38.9-38.9S60.4,262.8,38.9,262.8z M38.9,378.7 C17.4,378.7,0,396.1,0,417.6s17.4,38.9,38.9,38.9s38.9-17.4,38.9-38.9C77.8,396.2,60.4,378.7,38.9,378.7z"/> </svg><span class="plyr__tooltip">Chapter</span>',s.classList="h5vp-chapter-wrapper",n.classList="h5vp-chapter-list-wrapper",i.classList="h5vp-chapter-list",t.map(t=>{if(""!=(t?.label||t?.name)&&""!=t?.time){const r=this.chapterTimeToSeconds(t?.time),s=document.createElement("button");s.innerHTML=`<span>${t?.label}</span>`,i.appendChild(s),s.onclick=()=>{i.classList.remove("showing"),this.player.currentTime=r,this.player.play()},a.onclick=()=>{i.classList.contains("showing")?i.classList.remove("showing"):i.classList.add("showing")},e.addEventListener("click",function(e){i.contains(e.target)||a.contains(e.target)||i.classList.contains("showing")&&i.classList.remove("showing")}),this.onClick(e.querySelector(".plyr__controls__item.plyr__menu button"),function(){i.classList.contains("showing")&&i.classList.remove("showing")})}}),n?.appendChild(i),this.player.on("ready",()=>{const t=e.querySelector(".plyr__controls__item.plyr__volume"),r=e.querySelector(".plyr__controls__item.plyr__menu"),s=e.querySelector(".plyr__controls__item[data-plyr='fullscreen']"),i=e.querySelector(".plyr__controls__item.plyr__time--current.plyr__time");t?t.before(a):r?r.before(a):s?s.before(a):i&&i.before(a),e.querySelector(".plyr__controls")?.after(n)})}watermark(e={}){const{enabled:t,type:r,text:s,color:n}=e,a=this.player.elements?.container;if(!a||!t)return!1;let i=s;setTimeout(async()=>{if(["email","name"].includes(r))try{this.disabled=!0;const e=await wp.ajax.post("watermark_data",{nonce:this.nonce||window.h5vpBlock?.nonce});i=e.user[r]||window.location.origin,this.disabled=!1}catch(e){console.warn(e),this.disabled=!1}let e="watermark";this.player.on("play",()=>{if(!this.isPremium)return!1;const t=setInterval(()=>{const t=document.querySelector(e);t&&a.removeChild(t),e="watermark"+Math.round(1e3*Math.random());const s=document.createElement(e);s.setAttribute("style","display: block !important"),"email"===r&&(s.innerText=i),a.appendChild(s),s.innerText=i,s.setAttribute("style",`position:absolute; display:block !important; opacity:1 !important;top: ${Math.round(90*Math.random())}% !important; left: ${Math.round(70*Math.random())}% !important; transform: none !important`),s.style.color=n,a.appendChild(s)},2e3);this.player.on("pause",()=>{setTimeout(()=>{clearInterval(t);const r=document.querySelector(e);r&&a.removeChild(r)},0)})})},100)}thumbInPause(){if(this.features?.thumbInPause?.enabled)if("custom"==this.features.thumbInPause?.type){const e=document.createElement("img"),t=this.player?.elements?.buttons?.play?.[0];this.player.on("ready",()=>{e.src=this.poster;const t=this.player?.elements?.buttons?.play?.[0];t&&(t.classList.add("thumbInPause"),this.poster&&t.appendChild(e))}),this.player.on("play",()=>{t?.classList.remove("thumbInPause")}),this.player.on("pause",()=>{t?.classList.add("thumbInPause")})}else this.player.on("pause",()=>{this.player?.elements?.container&&this.player?.elements?.container.classList.add("plyr--stopped")})}destroy(){this.player?.destroy()}chapterTimeToSeconds(e=""){const t=e.toString().match(/(\d+):(\d+)/);return null==t?parseInt(e):60*parseInt(t[1])+parseInt(t[2])}getTTT(e=10,t=10){return e/100*t-e/100*(100-t)}onClick(e,t){e&&e.addEventListener("click",t)}on(e,t){this.player?.on(e,t)}setNonce(e){this.nonce=e}setVideoId(e){this.videoId=e}videoHls(){const e=()=>{if(window.Hls?.isSupported()){const e=new window.Hls;e.loadSource(this.player.media.src),this.player.on("ready",()=>{e.attachMedia(this.player.media)}),this.player.ready&&e.attachMedia(this.player.media),e.on(window.Hls.Events.MANIFEST_PARSED,()=>{["metadata","none"].includes(this.options.preload)&&setTimeout(()=>{e.stopLoad()},1e3),this.player.on("play",function(){e.startLoad()})}),this.player?.on("languagechange",()=>{setTimeout(()=>e.subtitleTrack=this.player.currentTrack,50)})}else console.warn("Hls does not support")};let t=document.getElementById("h5vp-hls-js");t?e():(t=document.createElement("script"),t.setAttribute("id","h5vp-hls-js"),t.src=this.local?.hls,document.getElementsByTagName("head")[0]?.prepend(t),t?.addEventListener("load",()=>e()))}videoDash(){let e=document.getElementById("h5vp-dash-js");e?dashjs&&(window.dashjs.MediaPlayer().create().initialize(this.player.media,this.media.src,!0),this.player=new Plyr(this.player.media)):(e=document.createElement("script"),e.setAttribute("id","h5vp-dash-js"),e.src=this.local?.dash,document.getElementsByTagName("head")[0]?.prepend(e),e.addEventListener("load",()=>{dashjs&&window.dashjs.MediaPlayer().create().initialize(this.player.media,this.player.media.src,!0)}))}controlTouchAction(){if(document.body.offsetWidth>992)return!1;const e=this.player.elements?.container;if(!e)return!1;const t=this.player,r=e.querySelector(".plyr__video-wrapper"),s=document.createElement("span");s.classList.add("seekSecond"),r.appendChild(s),t.eventListeners.forEach(t=>{"dblclick"===t.type&&e.removeEventListener(t.type,t.callback,t.options)}),r.parentNode.addEventListener("dblclick",e=>{let t=e.target.getBoundingClientRect(),n=e.clientX-t.left;this.player.fullscreen.active&&(r.offsetWidth-150<n&&r.offsetWidth/2<n?(this.player.forward(this.options.seekTime),s.innerText=this.options.seekTime+" sec"):r.offsetWidth/2>n&&n<150&&(this.player.rewind(this.options.seekTime),s.innerText="-"+this.options.seekTime+" sec"),setTimeout(()=>{s.innerText=""},1e3)),n>150&&n<r.offsetWidth-150&&this.player.fullscreen.toggle()}),e.addEventListener("touchstart",e=>{this.player.fullscreen.active&&(this.touchClientX=e.touches[0].clientX,this.touchClientY=e.touches[0].clientY)},!1),e.addEventListener("touchend",e=>{if(!this.player.fullscreen.active)return;let r;r=e.changedTouches[0].clientX-this.touchClientX,r>5?(t.forward(parseInt(r)/10),s.innerText=parseInt(r/10)+" sec"):r<-5&&(t.rewind(Math.abs(r)/10),s.innerText=parseInt(r/10)+" sec"),setTimeout(()=>{s.innerText=""},1e3)},!1)}pauseOther(){if(location.pathname.includes("wp-admin"))return!1;window.hpublic?.pauseOther&&this.player.on("play",()=>{const e=this.player.elements.fullscreen?.dataset?.uniqueId;document.querySelectorAll(`video:not([data-unique-id="${e}"] video, a video)`).forEach(e=>e.pause())})}domAttributesToObjectList(e){const t=[];return e.forEach(e=>{const r=e.attributes,s={};for(let e=0;e<r.length;e++){const t=r[e];s[t.name]=t.value}t.push(s)}),t}getStoredSettings(){return JSON.parse(window.localStorage.getItem("plyr"))}landScapeWhenFullscreen(){window?.innerWidth<992&&(this.player.on("enterfullscreen",()=>{screen?.orientation?.lock("landscape")}),this.player.on("exitfullscreen",()=>{screen?.orientation?.lock("portrait")}))}},K=({enabled:t,items:r})=>t?(0,e.createElement)(e.Fragment,null,r.map((t,r)=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)("style",null,`\n              .overlay_item_${r} p{\n                padding: 5px 12px;\n              }\n              .overlay_item_${r} p,\n              .overlay_item_${r} img,\n              .overlay_item_${r} a {\n              color: ${t.color};\n              font-size: ${t.fontSize};\n              background-color: ${t.backgroundColor};\n              border-radius: 3px px;\n              opacity: ${t.opacity}\n            }\n            .overlay_item_${r} a:hover,\n            .overlay_item_${r} p:hover {\n              color: ${t.hoverColor};\n            }\n            `.replace(/\s+/g," ")),(0,e.createElement)("div",{key:r,className:`h5vp_overlay ${t.position} overlay_item_${r}`},"text"===t.type?(0,e.createElement)("p",null,t.link?(0,e.createElement)("a",{href:t.link,rel:"noreferrer",target:"_blank"},t.text):(0,e.createElement)(e.Fragment,null,t.text)):t.link?(0,e.createElement)("a",{className:"background-transparent",href:t.link,rel:"noreferrer",target:"_blank"},(0,e.createElement)("img",{src:t.logo})):(0,e.createElement)("img",{src:t.logo}))))):(0,e.createElement)(e.Fragment,null),Y=({setOpen:t,popup:r,poster:s})=>{const{align:n,enabled:a,btnStyle:i,hasBtn:o,selector:l,type:c,btnText:p}=r,{padding:u,...d}=i||{};return(0,e.useEffect)(()=>{"button"===c&&o&&l&&a&&document.querySelector([".","#","["].includes(l)?`${l}`:`.${l}`)?.addEventListener("click",()=>{t(!0)})},[]),(0,e.createElement)(e.Fragment,null,a&&(0,e.createElement)("div",{className:"button"===c?`flex justify-${n}`:""},o&&"poster"!==c?(0,e.createElement)(e.Fragment,null):(0,e.createElement)(e.Fragment,null,"button"===c?(0,e.createElement)("button",{className:"popup_opener",onClick:()=>t(!0),style:{...d,padding:Object.values(u).join(" ")}},p):(0,e.createElement)(e.Fragment,null,s?(0,e.createElement)("div",{className:"popup_opener"},(0,e.createElement)("svg",{"aria-hidden":"true",focusable:"false",className:"popup_play",onClick:()=>t(!0)},(0,e.createElement)("use",{xlinkHref:"#plyr-play"})),(0,e.createElement)("img",{src:s,width:"100%"})):(0,e.createElement)("h3",null,"Poster missing"))),(0,e.createElement)("span",{onClick:()=>t(!1),className:"close"},"×")))},Z=({poster:t,source:r,isPremium:s,className:n="",reference:a,...i})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)("video",{crossOrigin:!0,className:n,id:"player","data-poster":t||"",ref:a,src:r,...i,style:{width:"100%",maxWidth:"100%"}},s&&(0,e.createElement)(e.Fragment,null,!["m3u8","mpd"].includes(r?.split(".").pop())&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("source",{src:r,size:720,type:`video/${r?.split(".").pop()}`})))),i["data-poster"]&&(0,e.createElement)("div",{className:"preload_poster",style:{background:`url(${i["data-poster"]})`}})),Q=({source:t="https://www.youtube.com/watch?v=MLpWrANjFbI",className:r="",...s})=>(0,e.createElement)("div",{className:`plyr__video-embed ${r}`,id:"player",...s},(0,e.createElement)("iframe",{src:t?`${t}?origin=${window.location.origin}&iv_load_policy=3&amp;modestbranding=1&amp;playsinline=1&amp;showinfo=0&amp;rel=0&amp;enablejsapi=1`:"",allowfullscreen:!0,allowtransparency:!0,allow:"autoplay"}),s["data-poster"]&&(0,e.createElement)("div",{className:"preload_poster",style:{background:`url(${s["data-poster"]})`}})),G=function(e){if(!e)return!1;const t=/^(https?:\/\/)?(www\.)?(player\.)?vimeo\.com\/(video\/)?(\d+)(\/[^\s]*)?$/,r=e?.match(t)?.[5];return r?`https://player.vimeo.com/video/${r}`:isNaN(e)?t.test(e):`https://player.vimeo.com/video/${e}`},ee=({endScreen:t,player:r})=>{const{enabled:s,text:n,btnText:a,btnLink:i}=t,o=(0,e.useRef)(null);return(0,e.useEffect)(()=>{r?.player?.on("ended",()=>{s&&(r.player.stop(),o.current.style.display="block")})},[r]),(0,e.createElement)(e.Fragment,null,s&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{ref:o,className:"h5vp_end_screen"},(0,e.createElement)("span",{className:"close",onClick:()=>{o.current.style.display="none"}},"×"),(0,e.createElement)("div",{className:"content"},(0,e.createElement)("p",null,n),a&&(0,e.createElement)("a",{target:"_blank",rel:"noreferrer",href:i},a)))))},te=({styles:t={},uniqueId:r})=>{const[s,n]=(0,e.useState)(null);return(0,e.useEffect)(()=>{let e="";"object"==typeof t&&Object.keys(t).map(s=>{if("object"==typeof t[s]){let n="";Object.keys(t[s]).map(e=>{var r;n+=`${r=e,r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}: ${t[s][e]};`}),e+=`#${r} ${[".","#"].includes(s[0])?"":"."}${s}{${n}} `}}),n(e)},[t,r]),(0,e.createElement)("style",{dangerouslySetInnerHTML:{__html:s}})},re=({source:t="https://player.vimeo.com/video/76979871",className:r="",...s})=>(0,e.createElement)("div",{className:`plyr__video-embed ${r}`,id:"player",...s},(0,e.createElement)("iframe",{src:t?`${t}?loop=false&amp;byline=false&amp;portrait=false&amp;title=false&amp;speed=true&amp;transparent=0&amp;gesture=media`:"",allowfullscreen:!0,allowtransparency:!0,allow:"autoplay"}),s["data-poster"]&&(0,e.createElement)("div",{className:"preload_poster",style:{background:`url(${s["data-poster"]})`}})),se=function(e){let t="";for(let r=0;r<e;r++){const e=Math.floor(52*Math.random());t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(e)}return t},ne=({height:t="10px",width:r="10px",color:s="#3498db",className:n="",style:a={}})=>(0,e.createElement)("div",{className:`simple-loader ${n}`,style:{height:t,width:r,borderTopColor:s,...a}}),ae=({passwordProtected:r,setSrc:s,nonce:n,src:a,setQualities:i})=>{const{enabled:o,heading:l,button:c,key:p,errorMessage:u}=r,{data:d,refetch:h,isLoading:m}=t("h5vp_ajax_handler",{nonce:n,method:"check_password",model:"Video",key:p},!0),[y,f]=(0,e.useState)(null),[_,v]=(0,e.useState)(null),{text:b="Access"}=c||{};return(0,e.useEffect)(()=>{f(null),m||(d?(s(d.source),i(d.quality)):null!==d&&f(u||"Password didn't matched"))},[m]),(0,e.createElement)(e.Fragment,null,o&&!a&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"password_form_overlay"}),(0,e.createElement)("div",{className:"password_form"},(0,e.createElement)("form",{onSubmit:e=>{e.preventDefault(),h({key:p,password:_})}},l&&(0,e.createElement)("h3",{className:"password_form_heading"},l),(0,e.createElement)("input",{type:"password",className:"password_form_input",placeholder:"Password",onChange:e=>v(e.target.value)}),(0,e.createElement)("button",{className:"password_form_button",disabled:m},m&&(0,e.createElement)(ne,{style:{borderWidth:"2px"}})," ",b),y&&(0,e.createElement)("p",{className:"password_form_error"},y)))))},ie=function(e,t){try{const r=atob(e);let s="";for(let e=0;e<r.length;e++)s+=String.fromCharCode(r.charCodeAt(e)^t.charCodeAt(e%t.length));return s}catch(t){return console.warn(t.message),e}},oe=({attributes:s,nonce:n=window.h5vpBlock?.nonce})=>{const{additionalCSS:a,additionalID:i,source:o,poster:l,provider:c,qualities:p,quality:u,subtitle:d,options:h,features:m,uniqueId:y,styles:f}=s,{popup:_,overlay:v,endScreen:b,passwordProtected:w={},hideYoutubeUI:g}=m,[E,S]=(0,e.useState)(w.enabled?"":ie(o,y)),[k,P]=(0,e.useState)(!1),[T,L]=(0,e.useState)("library"===c?"self-hosted":c),{autoplay:z,muted:C,loop:$}=h,{data:I,isLoading:N}=t("pipe_handler",{nonce:n}),{data:x}=t("h5vp_ajax_handler",{nonce:n,src:E,method:"get_id",model:"Video"}),[j,O]=(0,e.useState)(p||u),A=(0,e.useRef)(null),F=(0,e.useRef)(null);return(0,e.useEffect)(()=>{k?F.current?.player.play():F.current?.player.pause()},[k]),(0,e.useEffect)(()=>{A.media=A.current?.querySelector("#player")},[A]),(0,e.useEffect)(()=>{const e=A.current?.querySelector("#player");return e&&(F.current=new X(e,h,{...m,qualities:j,captions:d}),F.current.poster=l),()=>{F.current?.destroy()}},[h,m,j,d]),(0,e.useEffect)(()=>{F.current&&!F.current?.nonce&&F.current.setNonce(n),F.current&&!F.current?.videoId&&F.current.setVideoId(x)},[n,x,F.current]),(0,e.useEffect)(()=>{F.current&&F.current.setIsPremium(I),N||I||"self-hosted"===T||F.current?.destroy()},[I,N,T,F.current]),(0,e.useEffect)(()=>{T||(r(o)?L("youtube"):G(o)?L("vimeo"):L("self-hosted"))},[o]),(0,e.useEffect)(()=>{F.current?.player&&l&&F.current.setPoster(l)},[E,l]),(0,e.useEffect)(()=>{setTimeout(()=>{F.current?.player&&w.enabled&&F.current.dispatchEvent("update-source",{source:E,qualities:j})},0)},[E]),(0,e.useEffect)(()=>{window.sources?window.sources.push(o):window.sources=[o]},[E,o]),(0,e.useEffect)(()=>{S(w.enabled?"":ie(o,y))},[o]),o?(0,e.createElement)("div",{ref:A,id:y,className:`h5vp_player_temp  ${_.enabled?"h5vp_popup_enabled":""} ${k?"h5vp_popup_open":""}`},(0,e.createElement)(te,{styles:f,uniqueId:y}),(0,e.createElement)("style",null,a),I&&(0,e.createElement)(Y,{setOpen:P,popup:_,poster:l}),(0,e.createElement)(ae,{passwordProtected:w,nonce:n,src:E,setSrc:S,source:o,setQualities:O}),(0,e.createElement)("div",{className:"plyr_wrapper "+(g?"hideUI":""),id:i,"data-unique-id":se(5)},(0,e.createElement)(e.Fragment,null,"vimeo"===T&&(0,e.createElement)(re,{source:G(E)}),"youtube"===T&&(0,e.createElement)(Q,{source:r(E)})),["self-hosted","amazons3"].includes(T)&&(0,e.createElement)(Z,{qualities:E?j:[],source:(w.enabled,E),poster:l,autoPlay:z,muted:C,loop:$?.active,preload:h.preload,isPremium:I,playsInline:h.playsinline}),I&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(ee,{endScreen:b,player:F.current}),(0,e.createElement)(K,{...v,player:F.current?.player})))):(0,e.createElement)("h3",null,"Video source missing")},{createRoot:le}=ReactDOM;document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('[class^="wp-block-html5-player-"]').forEach(t=>{if(!t.dataset.attributes||!t.dataset.nonce)return;const r=JSON.parse(t.dataset.attributes),s=t.dataset.nonce;le(t).render((0,e.createElement)(oe,{attributes:r,nonce:s})),t.removeAttribute("data-attributes"),t.removeAttribute("data-nonce")})}),window.addEventListener("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/H5VPPlayer.default",function(t){const r=t[0].querySelector(".html5_video_players");if(!r.dataset.attributes||!r.dataset.nonce)return;const s=JSON.parse(r.dataset.attributes),n=r.dataset.nonce;le(r).render((0,e.createElement)(oe,{attributes:s,nonce:n})),r.removeAttribute("data-attributes"),r.removeAttribute("data-nonce")})})})();